{"version":3,"names":["TooltipHelper","constructor","reference","tooltip","this","tooltipPosition","showTooltip","matches","_a","showPopover","hideTooltip","canHideTooltip","hidePopover","addTriggerEventListeners","connect","setAttribute","updateCallback","computePosition","strategy","placement","middleware","offset","flip","elementContext","boundary","document","body","hide","then","x","y","middlewareData","Object","assign","style","visibility","referenceHidden","left","top","stopAutoUpdate","autoUpdate","disconnect","removeTriggerEventListeners","setTooltipPosition","position","addEventListener","removeEventListener","soulTooltipCss","SoulTooltipComponent","disconnectedCallback","tooltipHelper","componentDidLoad","initializeTooltipHelper","render","h","Host","class","ref","el","tooltipElement","role","text","isDefined","triggerId","triggerElement","isEmptyString","getTriggerElement","getElementById"],"sources":["./src/services/TooltipHelper.ts","./src/components/soul-tooltip/soul-tooltip.scss?tag=soul-tooltip&encapsulation=shadow","./src/components/soul-tooltip/soul-tooltip.component.tsx"],"sourcesContent":["import {autoUpdate, computePosition, flip, hide, offset, Placement} from '@floating-ui/dom';\nimport {HTMLPopoverElement} from '../types/PopoverElement';\n\nexport class TooltipHelper {\n\n  private reference: HTMLElement;\n  private tooltip: HTMLPopoverElement;\n  private tooltipPosition: Placement = 'top-start';\n  private stopAutoUpdate: () => void;\n\n  constructor(reference: HTMLElement, tooltip: HTMLElement) {\n    this.reference = reference;\n    this.tooltip = tooltip as HTMLPopoverElement;\n    this.addTriggerEventListeners();\n  }\n\n  public showTooltip = () => {\n    if (this.reference.matches(':focus') || this.reference.matches(':hover')) {\n      this.tooltip?.showPopover();\n    }\n  };\n\n  public hideTooltip = () => {\n    if (this.canHideTooltip()) {\n      this.tooltip.hidePopover();\n    }\n  };\n\n  public connect(): void {\n    if (!this.tooltip || !this.reference) {\n      return;\n    }\n    this.tooltip.setAttribute('popover', 'manual');\n\n    const updateCallback = () => {\n      computePosition(this.reference, this.tooltip,\n        {\n          strategy: 'fixed',\n          placement: this.tooltipPosition,\n          middleware: [\n            offset(1),\n            flip({elementContext: 'reference'}),\n            flip({boundary: document.body}),\n            hide({elementContext: 'reference'}),]\n        }).then(({x, y, middlewareData}) => {\n        if (middlewareData.hide) {\n          Object.assign(this.tooltip.style, {\n            visibility: middlewareData.hide.referenceHidden ? 'hidden' : 'visible'\n          });\n        }\n        Object.assign(this.tooltip.style, {\n          left: `${x}px`,\n          top: `${y}px`\n        });\n      });\n    };\n\n    this.stopAutoUpdate = autoUpdate(this.reference, this.tooltip, updateCallback);\n  }\n\n  public disconnect(): void {\n    this.removeTriggerEventListeners();\n    this.stopAutoUpdate && this.stopAutoUpdate();\n  }\n\n  public setTooltipPosition(position: Placement): void {\n    this.tooltipPosition = position;\n  }\n\n  private addTriggerEventListeners(): void {\n    this.reference.addEventListener('mouseenter', this.showTooltip);\n    this.reference.addEventListener('mouseleave', this.hideTooltip);\n    this.reference.addEventListener('focus', this.showTooltip);\n    this.reference.addEventListener('blur', this.hideTooltip);\n  }\n\n  private removeTriggerEventListeners(): void {\n    this.reference.removeEventListener('mouseenter', this.showTooltip);\n    this.reference.removeEventListener('mouseleave', this.hideTooltip);\n    this.reference.removeEventListener('focus', this.showTooltip);\n    this.reference.removeEventListener('blur', this.hideTooltip);\n  }\n\n  private canHideTooltip(): boolean {\n    return !this.reference.matches(':focus') && !this.reference.matches(':hover');\n  }\n}\n","@use \"modules/core\";\n\n.soul-tooltip {\n  position: fixed;\n  padding: core.$soul-space-squish-2-xs;\n  border-radius: core.$soul-border-radius-m;\n  margin: 0;\n  border: 0;\n  background-color: core.$soul-color-background-inverse-default;\n  color: core.$soul-color-text-on-dark;\n}\n\n.soul-tooltip--hidden {\n  visibility: hidden;\n}\n\n:host([status=\"warning\"]) {\n  .soul-tooltip {\n    background-color: core.$soul-color-background-status-warning;\n    color: core.$soul-color-text-on-light;\n  }\n}\n\n:host([status=\"critical\"]) {\n  .soul-tooltip {\n    background-color: core.$soul-color-background-status-critical;\n    color: core.$soul-color-text-on-dark;\n  }\n}\n","import {Component, Host, h, JSX, Prop, ComponentDidLoad, Watch} from '@stencil/core';\nimport {TooltipHelper} from '../../services/TooltipHelper';\nimport {isDefined, isEmptyString} from '../../utils/utils';\n\n@Component({\n  tag: 'soul-tooltip',\n  styleUrl: 'soul-tooltip.scss',\n  shadow: true\n})\nexport class SoulTooltipComponent implements ComponentDidLoad {\n\n  @Prop({reflect: true}) position: 'top' | 'top-start' | 'top-end' | 'right' | 'right-start' | 'right-end' | 'bottom' | 'bottom-start' | 'bottom-end' | 'left' | 'left-start' | 'left-end' = 'top-start';\n  @Prop({reflect: true}) status: 'warning' | 'critical';\n  @Prop({reflect: true}) triggerId: string;\n  @Prop({reflect: true}) text: string;\n  @Prop({reflect: false}) triggerElement: HTMLElement;\n\n  private tooltipElement: HTMLDivElement;\n  private tooltipHelper: TooltipHelper;\n\n  public disconnectedCallback(): void {\n    this.tooltipHelper?.disconnect();\n  }\n\n  public componentDidLoad(): void {\n    this.initializeTooltipHelper();\n  }\n\n  public render(): JSX.Element {\n    return (\n      <Host>\n        <div class={{'soul-tooltip': true, 'soul-tooltip--hidden': this.hideTooltip}} ref={el => this.tooltipElement = el as HTMLDivElement} role=\"tooltip\">\n          {this.text}</div>\n      </Host>\n    );\n  }\n\n  private get hideTooltip(): boolean {\n    return (!isDefined(this.triggerId) && !isDefined(this.triggerElement)) || (isEmptyString(this.text) || !isDefined(this.text));\n  }\n\n  @Watch('triggerId')\n  @Watch('triggerElement')\n  private initializeTooltipHelper(): void {\n    const triggerElement = this.getTriggerElement();\n    this.tooltipHelper?.disconnect();\n    if (isDefined(triggerElement)) {\n      this.tooltipHelper = new TooltipHelper(triggerElement, this.tooltipElement);\n      this.setTooltipPosition();\n      this.tooltipHelper.connect();\n      this.tooltipHelper.showTooltip();\n    }\n  }\n\n  @Watch('position')\n  private setTooltipPosition(): void {\n    this.tooltipHelper?.setTooltipPosition(this.position);\n  }\n\n  private getTriggerElement(): HTMLElement | null {\n    return isDefined(this.triggerElement) ? this.triggerElement : document.getElementById(this.triggerId);\n  }\n\n}\n"],"mappings":"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"}